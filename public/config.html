<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Widget Config</title>
  <style>
    body{margin:0;font-family:system-ui,-apple-system,"Apple SD Gothic Neo","Noto Sans KR",sans-serif;}
    .wrap{max-width:720px;padding:16px;}
    .card{border:1px solid rgba(0,0,0,.1);border-radius:16px;padding:14px;}
    label{font-size:12px;opacity:.7;}
    input{width:100%;padding:10px;border-radius:12px;border:1px solid rgba(0,0,0,.1);font-size:14px;box-sizing:border-box;}
    .grid{display:grid;grid-template-columns:1fr;gap:10px;}
    .row{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px;}
    button{padding:10px 12px;border-radius:12px;border:1px solid rgba(0,0,0,.1);background:#fff;cursor:pointer;}
    .out{margin-top:10px;font-size:13px;word-break:break-all;}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h3 style="margin:0 0 10px 0;">노션 유튜브 위젯 설정</h3>

      <div class="grid">
        <div>
          <label>채널(채널ID UC… 추천)</label>
          <input id="inChannel" value="UCAjeAuHbqjpFH4u4KHgSN6g" />
        </div>
        <div>
          <label>목표 구독자</label>
          <input id="inGoal" value="1000" />
        </div>
        <div>
          <label>라벨</label>
          <input id="inLabel" value="구독자 달성률" />
        </div>
        <div>
          <label>갱신(초) (권장 21600=6시간)</label>
          <input id="inRefresh" value="21600" />
        </div>
      </div>

      <div class="row">
        <button id="btnCopy">노션 임베드 링크 복사</button>
        <button id="btnOpen">미리보기 열기</button>
      </div>

      <div class="out" id="out"></div>
    </div>
  </div>

<script>
  const inChannel = document.getElementById("inChannel");
  const inGoal = document.getElementById("inGoal");
  const inLabel = document.getElementById("inLabel");
  const inRefresh = document.getElementById("inRefresh");
  const out = document.getElementById("out");

  function makeUrl(){
    const u = new URL(location.origin + "/widget.html");
    u.searchParams.set("channel", inChannel.value.trim());
    u.searchParams.set("goal", String(Number(inGoal.value || "1000")));
    u.searchParams.set("label", inLabel.value.trim() || "구독자 달성률");
    u.searchParams.set("refresh", String(Number(inRefresh.value || "21600")));
    return u.toString();
  }

  function refreshOut(){
    out.textContent = makeUrl();
  }
  ["input","change"].forEach(ev=>{
    inChannel.addEventListener(ev, refreshOut);
    inGoal.addEventListener(ev, refreshOut);
    inLabel.addEventListener(ev, refreshOut);
    inRefresh.addEventListener(ev, refreshOut);
  });
  refreshOut();

  document.getElementById("btnOpen").onclick = () => window.open(makeUrl(), "_blank");
  document.getElementById("btnCopy").onclick = async () => {
    const u = makeUrl();
    try { await navigator.clipboard.writeText(u); alert("복사 완료!"); }
    catch { prompt("복사해서 쓰세요:", u); }
  };
</script>
</body>
</html>
